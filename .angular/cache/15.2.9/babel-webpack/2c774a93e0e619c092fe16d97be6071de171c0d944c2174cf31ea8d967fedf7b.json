{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport * as firebaseDatabase from \"@angular/fire/database\";\nimport { take, BehaviorSubject, tap } from 'rxjs';\nimport { faPenToSquare, faTrash } from '@fortawesome/free-solid-svg-icons';\nimport Swal from \"sweetalert2\";\nimport { CadastroEmployeesComponent } from '../cadastroEmployees/cadastroEmployees.component';\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/database\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@fortawesome/angular-fontawesome\";\nfunction ListaEmployeesComponent_div_1_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"fa-icon\", 13);\n    i0.ɵɵlistener(\"click\", function ListaEmployeesComponent_div_1_div_17_Template_fa_icon_click_1_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const employee_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.update(employee_r2));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"fa-icon\", 14);\n    i0.ɵɵlistener(\"click\", function ListaEmployeesComponent_div_1_div_17_Template_fa_icon_click_2_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const employee_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.delete(employee_r2));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"title\", ctx_r4.tooltips.editar);\n    i0.ɵɵproperty(\"icon\", ctx_r4.faEdit);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"title\", ctx_r4.tooltips.excluir);\n    i0.ɵɵproperty(\"icon\", ctx_r4.faDelete);\n  }\n}\nfunction ListaEmployeesComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 3)(1, \"div\", 4);\n    i0.ɵɵelement(2, \"img\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 6)(4, \"h5\", 7);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 8);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\", 8);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\", 8);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\", 8);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"div\", 9)(15, \"p\", 10);\n    i0.ɵɵlistener(\"click\", function ListaEmployeesComponent_div_1_Template_p_click_15_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const i_r3 = restoredCtx.index;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.openControl(i_r3));\n    });\n    i0.ɵɵtext(16, \"...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(17, ListaEmployeesComponent_div_1_div_17_Template, 3, 4, \"div\", 11);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const employee_r2 = ctx.$implicit;\n    const i_r3 = ctx.index;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", employee_r2.foto, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", employee_r2.nome, \" \", employee_r2.sobrenome, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\" Sexo: \", employee_r2.genero, \" Idade: \", employee_r2.idade, \", Cabelos: \", employee_r2.corCabelo, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(employee_r2.endereco);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(employee_r2.telefone);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Sal\\u00E1rio: \", employee_r2.salario, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.showControls && ctx_r0.indexControl == i_r3);\n  }\n}\nfunction ListaEmployeesComponent_section_3_app_cadastroEmployees_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-cadastroEmployees\", 17);\n    i0.ɵɵlistener(\"closeCadastroForm\", function ListaEmployeesComponent_section_3_app_cadastroEmployees_1_Template_app_cadastroEmployees_closeCadastroForm_0_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.finishedCrud());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"employeeToEdit\", ctx_r12.selectedEmployee)(\"actionToPerform\", ctx_r12.actionToPerform)(\"keyToUpdate\", ctx_r12.keyToUpdate);\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"showForm\": a0\n  };\n};\nfunction ListaEmployeesComponent_section_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\", 15);\n    i0.ɵɵtemplate(1, ListaEmployeesComponent_section_3_app_cadastroEmployees_1_Template, 1, 3, \"app-cadastroEmployees\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx_r1.selectedEmployee !== undefined));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.selectedEmployee !== undefined);\n  }\n}\nexport let ListaEmployeesComponent = /*#__PURE__*/(() => {\n  var _class;\n  class ListaEmployeesComponent {\n    constructor(_database) {\n      this._database = _database;\n      this.employees$ = new BehaviorSubject([]);\n      this.subscriptions = [];\n      this.employeesDatabaseRef = firebaseDatabase.ref(this._database, 'empregados');\n      this.keyToUpdate = \"\";\n      this.databaseKeysRef = {};\n      this.actionToPerform = \"none\";\n      this.showControls = false;\n      this.indexControl = -1;\n      this.faEdit = faPenToSquare;\n      this.faDelete = faTrash;\n      this.tooltips = {\n        editar: \"Clique aqui para editar o empregado\",\n        excluir: \"Clique aqui para excluir o empregado\"\n      };\n    }\n    ngOnDestroy() {\n      this.unsubscribe();\n    }\n    ngOnInit() {\n      this.getAllEmployees();\n    }\n    update(employee) {\n      this.actionToPerform = \"Atualizar\";\n      this.selectedEmployee = employee;\n      const selectedKey = employee.id;\n      this.keyToUpdate = this.databaseKeysRef[selectedKey];\n    }\n    openControl(index) {\n      this.showControls = true;\n      this.indexControl = index;\n    }\n    delete(employee) {\n      Swal.fire({\n        title: `Deseja mesmo remover ${employee.nome} ${employee.sobrenome}?`,\n        showDenyButton: true,\n        showCancelButton: true,\n        confirmButtonText: 'Remover',\n        denyButtonText: `Não Remover`\n      }).then(result => {\n        /* Read more about isConfirmed, isDenied below */\n        if (result.isConfirmed) {\n          this.actionToPerform = \"Deletar\";\n          const selectedKey = employee.id;\n          this.keyToUpdate = this.databaseKeysRef[selectedKey];\n          this.selectedEmployee = employee;\n          const key = this.keyToUpdate;\n          const employeeRef = firebaseDatabase.ref(this._database, `empregados/${key}`);\n          try {\n            firebaseDatabase.remove(employeeRef);\n            Swal.fire({\n              title: 'Sucesso 😍',\n              text: \"Empregado removido com sucesso!\",\n              icon: 'success'\n            });\n          } catch (error) {\n            Swal.fire({\n              title: 'Ah que pena! :(',\n              text: `Não foi possível remover o empregado! Erro: ${error}`,\n              icon: 'error'\n            });\n          }\n        } else if (result.isDenied) {\n          Swal.fire('Remoção cancelada', '', 'info');\n        }\n      });\n    }\n    finishedCrud() {\n      this.actionToPerform = \"none\";\n      this.selectedEmployee = undefined;\n      this.indexControl = -1;\n      this.getAllEmployees();\n    }\n    getAllEmployees() {\n      this.subscriptions.push(firebaseDatabase.objectVal(this.employeesDatabaseRef).pipe(take(1), tap(employes => {\n        for (const key in employes) {\n          this.databaseKeysRef[employes[key].id] = key;\n        }\n      })).subscribe(response => {\n        const array = Object.values(response);\n        this.employees$.next(array);\n        this.unsubscribe();\n      }));\n      return this.employees$.asObservable();\n    }\n    unsubscribe() {\n      this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n  }\n  _class = ListaEmployeesComponent;\n  _class.ɵfac = function ListaEmployeesComponent_Factory(t) {\n    return new (t || _class)(i0.ɵɵdirectiveInject(i1.Database));\n  };\n  _class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _class,\n    selectors: [[\"app-listaEmployees\"]],\n    standalone: true,\n    features: [i0.ɵɵProvidersFeature([]), i0.ɵɵStandaloneFeature],\n    decls: 4,\n    vars: 4,\n    consts: [[1, \"employees\", \"col-12\", \"d-flex\", \"flex-wrap\", \"justify-content-around\", \"p-md-5\"], [\"class\", \"card justify-content-center mb-5 ml-3 col-12 col-sm-12 col-md-5 col-lg-3 col-xl-4 \", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"crud\", 3, \"ngClass\", 4, \"ngIf\"], [1, \"card\", \"justify-content-center\", \"mb-5\", \"ml-3\", \"col-12\", \"col-sm-12\", \"col-md-5\", \"col-lg-3\", \"col-xl-4\"], [1, \"card-header\", \"d-flex\", \"justify-content-center\"], [\"alt\", \"Card image cap\", 1, \"card-img-top\", 3, \"src\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"card-text\"], [1, \"card-footer\", \"text-right\"], [3, \"click\"], [\"class\", \"d-flex justify-content-end\", 4, \"ngIf\"], [1, \"d-flex\", \"justify-content-end\"], [\"data-toggle\", \"tooltip\", \"data-placement\", \"top\", 1, \"mr-1\", 3, \"title\", \"icon\", \"click\"], [\"data-toggle\", \"tooltip\", \"data-placement\", \"top\", 3, \"title\", \"icon\", \"click\"], [1, \"crud\", 3, \"ngClass\"], [3, \"employeeToEdit\", \"actionToPerform\", \"keyToUpdate\", \"closeCadastroForm\", 4, \"ngIf\"], [3, \"employeeToEdit\", \"actionToPerform\", \"keyToUpdate\", \"closeCadastroForm\"]],\n    template: function ListaEmployeesComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0);\n        i0.ɵɵtemplate(1, ListaEmployeesComponent_div_1_Template, 18, 10, \"div\", 1);\n        i0.ɵɵpipe(2, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, ListaEmployeesComponent_section_3_Template, 2, 4, \"section\", 2);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(2, 2, ctx.employees$));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedEmployee !== undefined);\n      }\n    },\n    dependencies: [CommonModule, i2.NgClass, i2.NgForOf, i2.NgIf, i2.AsyncPipe, CadastroEmployeesComponent, FontAwesomeModule, i3.FaIconComponent],\n    styles: [\"img[_ngcontent-%COMP%]{width:150px;border-radius:50%}.card[_ngcontent-%COMP%]{box-shadow:0 0 16px 2px #a7a2a2}.card-footer[_ngcontent-%COMP%]{border:none!important;border-top:nome!important;text-align:right!important}.text-right[_ngcontent-%COMP%]{text-align:right!important}.mr-1[_ngcontent-%COMP%]{margin-right:10px}.crud[_ngcontent-%COMP%]{display:none;position:fixed;inset:0;background-color:#0000004d;z-index:3}.crud[_ngcontent-%COMP%]   app-cadastroEmployees[_ngcontent-%COMP%]{z-index:5}.showForm[_ngcontent-%COMP%]{display:flex;justify-content:center}fa-icon[_ngcontent-%COMP%]{color:#0d5680}\"]\n  });\n  return ListaEmployeesComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}